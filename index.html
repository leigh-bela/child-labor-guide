<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Child Labor Investigation Guide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .card {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .step {
            display: none;
        }
        .step.active {
            display: block;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.2s;
            width: 100%;
            max-width: 400px;
            text-align: left;
        }
        button:hover {
            background-color: #0056b3;
        }
        .actions {
            margin-top: 20px;
        }
        .progress {
            margin-bottom: 20px;
            color: #666;
            font-size: 0.9em;
        }
        .alert {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .info {
            background-color: #cce5ff;
            border: 1px solid #b8daff;
            color: #004085;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
        .navigation-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .navigation-buttons button {
            max-width: 150px;
        }
    </style>
</head>
<body>
    <div class="card">
        <div class="progress">Progress: Step <span id="currentStep">1</span></div>
        
        <!-- Initial Steps -->
        <div class="step active" id="step1">
            <h2>Document Upload</h2>
            <p>What type of document are you uploading to IMPACT Documents Tab?</p>
            <button onclick="handleChoice('step1', 'Standard complaint form')">Standard complaint form</button>
            <button onclick="handleChoice('step1', 'WCD injury report')">WCD injury report</button>
        </div>

        <div class="step" id="step2">
            <h2>Severity Assessment</h2>
            <p>Determine the severity of the complaint:</p>
            <button onclick="handleChoice('step2', 'Severe')">Severe/Fatal (death, loss of limb, hazardous occupation)</button>
            <button onclick="handleChoice('step2', 'Less severe')">Less severe (rest periods, minor injuries)</button>
        </div>

        <div class="step" id="step3">
            <h2>CLU Database Check</h2>
            <p>Check the CLU Database for the employer:</p>
            <div class="info">
                <ul>
                    <li>Search employer name/address</li>
                    <li>Review Certificates tab</li>
                    <li>Verify current year validity</li>
                </ul>
            </div>
            <p>Does the employer have a valid Annual Employment Certificate?</p>
            <button onclick="handleChoice('step3', 'Yes')">Yes</button>
            <button onclick="handleChoice('step3', 'No')">No</button>
        </div>

        <!-- Certificate Valid Path -->
        <div class="step" id="step4_valid">
            <h2>Violation History Check</h2>
            <p>Check for recent violations and compliance agreements:</p>
            <button onclick="handleChoice('step4_valid', 'No violations')">No recent violations or compliance agreements</button>
            <button onclick="handleChoice('step4_valid', 'Has violations')">Has recent violations or compliance agreements</button>
        </div>

        <div class="step" id="step5_injury">
            <h2>Injury Assessment</h2>
            <p>Does the complaint involve an injury?</p>
            <button onclick="handleChoice('step5_injury', 'No injury')">No injury</button>
            <button onclick="handleChoice('step5_injury', 'Has injury')">Yes, involves injury</button>
        </div>

        <!-- No Certificate Path -->
        <div class="step" id="step4_invalid">
            <h2>Special Agriculture Overtime</h2>
            <p>Is this a Special Agriculture Overtime Permit case?</p>
            <button onclick="handleChoice('step4_invalid', 'Yes')">Yes</button>
            <button onclick="handleChoice('step4_invalid', 'No')">No</button>
        </div>

        <!-- Warning Letters Path -->
        <div class="step" id="warning_letters">
            <h2>Send Warning Letters</h2>
            <p>Required Actions:</p>
            <div class="info">
                <ul>
                    <li>Send appropriate warning letters:
                        <ul>
                            <li>Rest/meal periods</li>
                            <li>Hours for 16-17 yr olds</li>
                            <li>Agriculture for under 16</li>
                        </ul>
                    </li>
                    <li>Send warning draft to manager for review</li>
                    <li>After approval, close case - Code 47</li>
                </ul>
            </div>
            <button onclick="handleChoice('warning_letters', 'Complete')">Mark as Complete</button>
        </div>

        <!-- Injury Assessment Path -->
        <div class="step" id="injury_severity">
            <h2>Assess Injury Severity</h2>
            <p>What is the severity level of the injury?</p>
            <button onclick="handleChoice('injury_severity', 'Minor')">Minor/human error</button>
            <button onclick="handleChoice('injury_severity', 'Severe')">Severe or other violations discovered</button>
            <button onclick="handleChoice('injury_severity', 'Contributed')">Not severe but could have contributed</button>
        </div>

        <!-- Form 801 Path -->
        <div class="step" id="form801">
            <h2>Form 801 Request</h2>
            <p>Required Actions:</p>
            <div class="info">
                <ul>
                    <li>Request Form 801 - Detailed Injury Report from DCBS</li>
                    <li>Wait for employer response to warnings/certificate application</li>
                </ul>
            </div>
            <p>What is the employer's response status?</p>
            <button onclick="handleChoice('form801', 'No response')">No response to warnings</button>
            <button onclick="handleChoice('form801', 'No minors')">Responded - no longer employs minors</button>
            <button onclick="handleChoice('form801', 'Has violations')">Responded - has history of violations</button>
        </div>

        <!-- Response Wait Period -->
        <div class="step" id="wait_period">
            <h2>Response Period</h2>
            <div class="info">
                <p>Grant 10 Business Days for Response</p>
            </div>
            <p>Did the employer respond within the timeframe?</p>
            <button onclick="handleChoice('wait_period', 'Yes')">Yes, employer responded</button>
            <button onclick="handleChoice('wait_period', 'No')">No response received</button>
        </div>

        <!-- Follow Up Steps -->
        <div class="step" id="followup">
            <h2>Follow-up Steps</h2>
            <div class="info">
                <ul>
                    <li>Contact employer by phone/email</li>
                    <li>Interview witnesses</li>
                    <li>Research business status</li>
                    <li>Document all attempts</li>
                </ul>
            </div>
            <p>Is the business still active?</p>
            <button onclick="handleChoice('followup', 'Yes')">Yes, business is active</button>
            <button onclick="handleChoice('followup', 'No')">No, business appears closed</button>
        </div>

        <!-- Research Steps -->
        <div class="step" id="research">
            <h2>Research Steps</h2>
            <div class="info">
                <ul>
                    <li>Check Secretary of State</li>
                    <li>Search other locations</li>
                    <li>Document findings</li>
                    <li>Contact injured minor</li>
                    <li>Save all research</li>
                </ul>
            </div>
            <button onclick="handleChoice('research', 'Complete')">Complete Research and Close - No Serviceable Address</button>
        </div>

        <!-- Questionnaire Review -->
        <div class="step" id="review">
            <h2>Review Questionnaire</h2>
            <div class="info">
                <p>Check for violations in:</p>
                <ul>
                    <li>Certificate display</li>
                    <li>Work activities</li>
                    <li>Hours/schedules</li>
                    <li>Rest periods</li>
                    <li>Certificate type matches employment</li>
                </ul>
            </div>
            <p>What is the severity of violations found?</p>
            <button onclick="handleChoice('review', 'Severe')">Severe/Fatal</button>
            <button onclick="handleChoice('review', 'Contributed')">Not severe but contributed</button>
            <button onclick="handleChoice('review', 'Not severe')">Not severe</button>
        </div>

        <!-- Compliance Agreement -->
        <div class="step" id="agreement">
            <h2>Issue Compliance Agreement</h2>
            <div class="info">
                <ul>
                    <li>Generate WH-58 template</li>
                    <li>Include relevant ORS/OAR citations</li>
                    <li>Allow 10 days for signature</li>
                </ul>
            </div>
            <p>Did the employer sign the agreement?</p>
            <button onclick="handleChoice('agreement', 'Signed')">Yes, signed agreement</button>
            <button onclick="handleChoice('agreement', 'Changes')">Requested changes</button>
        </div>

        <!-- Case Closure -->
        <div class="step" id="closure">
            <h2>Complete Closure Steps</h2>
            <div class="info">
                <ul>
                    <li>Upload all documents to IMPACT</li>
                    <li>Move files to Closed_Referred folder</li>
                    <li>Update violations & participants</li>
                    <li>Add Investigation Complete activity</li>
                    <li>Close as Code 48</li>
                </ul>
            </div>
            <button onclick="handleChoice('closure', 'Complete')">Complete Case Closure</button>
        </div>

        <!-- Final Resources -->
        <div class="step" id="resources">
            <h2>Provide Resources</h2>
            <div class="info">
                <ul>
                    <li>BOLI Website links</li>
                    <li>Child labor summaries</li>
                    <li>Employer handbook</li>
                </ul>
            </div>
            <button onclick="handleChoice('resources', 'Complete')">Complete Investigation</button>
        </div>

        <div class="navigation-buttons">
            <button onclick="previousStep()" id="backButton" style="display: none;">← Back</button>
            <button onclick="startOver()" id="startOverButton" style="display: none;">Start Over</button>
        </div>
    </div>

    <script>
        let currentStepNumber = 1;
        const choices = {};
        let currentPath = [];

        function handleChoice(step, choice) {
            choices[step] = choice;
            
            if (step === 'step2' && choice === 'Severe') {
                alert('ACTION REQUIRED: Discuss this case with your manager immediately.');
            }

            // Determine next step based on current step and choice
            let nextStep;
            switch(step) {
                case 'step1':
                    nextStep = 'step2';
                    break;
                case 'step2':
                    nextStep = 'step3';
                    break;
                case 'step3':
                    nextStep = choice === 'Yes' ? 'step4_valid' : 'step4_invalid';
                    break;
                case 'step4_valid':
                    if (choice === 'Has violations') {
                        alert('ACTION REQUIRED: Review case with manager. May require WH-60 for APU to assess civil penalties.');
                        nextStep = 'step5_injury';
                    } else {
                        nextStep = 'step5_injury';
                    }
                    break;
                case 'step5_injury':
                    nextStep = choice === 'No injury' ? 'warning_letters' : 'injury_severity';
                    break;
                case 'step4_invalid':
                    if (choice === 'Yes') {
                        nextStep = 'wait_period';
                    } else {
                        nextStep = choices['step1'] === 'WCD injury report' ? 'form801' : 'wait_period';
                    }
                    break;
                case 'injury_severity':
                    if (choice === 'Minor') {
                        alert('ACTION REQUIRED: Discuss with manager - likely result in 80 - General Closure');
                        nextStep = null;
                    } else {
                        nextStep = 'wait_period';
                    }
                    break;
                case 'form801':
                    nextStep = 'wait_period';
                    break;
                case 'wait_period':
                    nextStep = choice === 'Yes' ? 'review' : 'followup';
                    break;
                case 'followup':
                    nextStep = choice === 'Yes' ? 'review' : 'research';
                    break;
                case 'review':
                    nextStep = 'agreement';
                    break;
                case 'agreement':
                    nextStep = choice === 'Signed' ? 'closure' : 'agreement';
                    if (choice === 'Changes') {
                        alert('ACTION REQUIRED: Manager must review requested changes');
                    }
                    break;
                case 'closure':
                    nextStep = 'resources';
                    break;
                case 'resources':
                    showSummary();
                    return;
                default:
                    nextStep = null;
            }

            if (nextStep) {
                currentPath.push(nextStep);
                showStep(nextStep);
            }
        }

        function showStep(stepId) {
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.getElementById(stepId).classList.add('active');
            currentStepNumber++;
            document.getElementById('currentStep').textContent = currentStepNumber;
            document.getElementById('backButton').style.display = currentPath.length > 0 ? 'inline' : 'none';
            document.getElementById('startOverButton').style.display = 'inline';
        }

        function previousStep() {
            if (currentPath.length > 0) {
                currentPath.pop(); // Remove current step
                currentStepNumber--;
                
                if (currentPath.length === 0) {
                    // If we're back at the start
                    document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
                    document.getElementById('step1').classList.add('active');
                    document.getElementById('backButton').style.display = 'none';
                } else {
                    // Show the previous step
                    document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
                    document.getElementById(currentPath[currentPath.length - 1]).classList.add('active');
                }
                
                document.getElementById('currentStep').textContent = currentStepNumber;
            }
        }

        function startOver() {
            currentStepNumber = 1;
            currentPath = [];
            choices = {};
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.getElementById('step1').classList.add('active');
            document.getElementById('currentStep').textContent = 1;
            document.getElementById('backButton').style.display = 'none';
            document.getElementById('startOverButton').style.display = 'none';
        }

        function showSummary() {
            let summaryHTML = `
                <div class="step active">
                    <h2>Investigation Summary</h2>
                    <div class="info">
                        <h3>Key Decisions:</h3>
                        <ul>`;
            
            for (let step in choices) {
                summaryHTML += `<li>${step}: ${choices[step]}</li>`;
            }
            
            summaryHTML += `
                        </ul>
                    </div>
                    <div class="alert">
                        <p>Investigation is complete. Please ensure all documentation is properly filed and all required actions have been taken.</p>
                    </div>
                </div>`;
            
            document.querySelector('.card').innerHTML = summaryHTML + `
                <div class="navigation-buttons">
                    <button onclick="startOver()" id="startOverButton">Start New Investigation</button>
                </div>`;
        }
    </script>
</body>
</html>
